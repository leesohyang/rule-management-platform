{"ast":null,"code":"// import * as d3 from \"d3\";\nimport * as d3 from \"d3\";\nimport \"@fortawesome/fontawesome-free/css/all.min.css\";\nimport styles from \"./ForceGraph.module.css\"; // import React from \"react\";\n\nexport function runForceGraph(container, linksData, nodesData, nodeHoverTooltip) {\n  console.log(linksData); // const dataTmp = useSelector(state=>state.fetchAPI.dataTmp)\n\n  const links = linksData.map(d => Object.assign({}, d));\n  const nodes = nodesData.map(d => Object.assign({}, d));\n  const containerRect = container.getBoundingClientRect();\n  const height = containerRect.height;\n  const width = containerRect.width;\n\n  const color = () => {\n    return \"#9D79A0\";\n  }; // const icon = (d) => {\n  //\n  //     return \"\\uf221\";\n  // }\n\n\n  const getClass = d => {\n    return styles.female;\n  };\n\n  const drag = simulation => {\n    const dragstarted = d => {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    };\n\n    const dragged = d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    };\n\n    const dragended = d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    };\n\n    return d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended);\n  }; // Add the tooltip element to the graph\n\n\n  const tooltip = document.querySelector(\"#graph-tooltip\");\n\n  if (!tooltip) {\n    const tooltipDiv = document.createElement(\"div\");\n    tooltipDiv.classList.add(styles.tooltip);\n    tooltipDiv.style.opacity = \"0\";\n    tooltipDiv.id = \"graph-tooltip\";\n    document.body.appendChild(tooltipDiv);\n  }\n\n  const div = d3.select(\"#graph-tooltip\");\n\n  const addTooltip = (hoverTooltip, d, x, y) => {\n    div.transition().duration(200).style(\"opacity\", 0.9);\n    div.html(hoverTooltip(d)).style(\"left\", `${x}px`).style(\"top\", `${y - 28}px`);\n  };\n\n  const removeTooltip = () => {\n    div.transition().duration(200).style(\"opacity\", 0);\n  };\n\n  const simulation = d3.forceSimulation(nodes).force(\"link\", d3.forceLink(links).id(d => d.id)).force(\"charge\", d3.forceManyBody().strength(-150)).force(\"x\", d3.forceX()).force(\"y\", d3.forceY());\n  d3.select(container).selectAll(\"svg\").remove();\n  const svg = d3.select(container).append(\"svg\").attr(\"viewBox\", [-width / 2, -height / 2, width, height]).call(d3.zoom().on(\"zoom\", function () {\n    svg.attr(\"transform\", d3.event.transform);\n  }));\n  const link = svg.append(\"g\").attr(\"stroke\", \"#999\").attr(\"stroke-opacity\", 0.6).selectAll(\"line\").data(links).join(\"line\").attr(\"stroke-width\", d => Math.sqrt(d.value));\n  const node = svg.append(\"g\").attr(\"stroke\", \"#fff\").attr(\"stroke-width\", 2).selectAll(\"circle\").data(nodes).join(\"circle\").attr(\"r\", 12).attr(\"fill\", color).call(drag(simulation));\n  const label = svg.append(\"g\").attr(\"class\", \"labels\").selectAll(\"text\").data(nodes).enter().append(\"text\").attr('text-anchor', 'bottom').attr('dominant-baseline', 'central').attr(\"class\", d => `fa ${getClass(d)}`) // .text(d => {return icon(d);})\n  .text(d => {\n    return d.name;\n  }).call(drag(simulation));\n  label.on(\"mouseover\", d => {\n    addTooltip(nodeHoverTooltip, d, d3.event.pageX, d3.event.pageY);\n  }).on(\"mouseout\", () => {\n    removeTooltip();\n  });\n  simulation.on(\"tick\", () => {\n    //update link positions\n    link.attr(\"x1\", d => d.source.x).attr(\"y1\", d => d.source.y).attr(\"x2\", d => d.target.x).attr(\"y2\", d => d.target.y); // update node positions\n\n    node.attr(\"cx\", d => d.x).attr(\"cy\", d => d.y); // update label positions\n\n    label.attr(\"x\", d => {\n      return d.x;\n    }).attr(\"y\", d => {\n      return d.y;\n    });\n  });\n  return {\n    destroy: () => {\n      simulation.stop();\n    },\n    nodes: () => {\n      return svg.node();\n    }\n  };\n}","map":{"version":3,"sources":["/home/leesohyang/WebstormProjects/fronted_react_final/src/components/ForceGraphGenerator.js"],"names":["d3","styles","runForceGraph","container","linksData","nodesData","nodeHoverTooltip","console","log","links","map","d","Object","assign","nodes","containerRect","getBoundingClientRect","height","width","color","getClass","female","drag","simulation","dragstarted","event","active","alphaTarget","restart","fx","x","fy","y","dragged","dragended","on","tooltip","document","querySelector","tooltipDiv","createElement","classList","add","style","opacity","id","body","appendChild","div","select","addTooltip","hoverTooltip","transition","duration","html","removeTooltip","forceSimulation","force","forceLink","forceManyBody","strength","forceX","forceY","selectAll","remove","svg","append","attr","call","zoom","transform","link","data","join","Math","sqrt","value","node","label","enter","text","name","pageX","pageY","source","target","destroy","stop"],"mappings":"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","sourcesContent":["// import * as d3 from \"d3\";\nimport * as d3 from \"d3\";\nimport \"@fortawesome/fontawesome-free/css/all.min.css\";\nimport styles from \"./ForceGraph.module.css\";\n// import React from \"react\";\n\nexport function runForceGraph(\n    container,\n    linksData,\n    nodesData,\n    nodeHoverTooltip,\n) {\n    console.log(linksData)\n    // const dataTmp = useSelector(state=>state.fetchAPI.dataTmp)\n\n    const links = linksData.map((d) => Object.assign({}, d));\n    const nodes = nodesData.map((d) => Object.assign({}, d));\n\n    const containerRect = container.getBoundingClientRect();\n    const height = containerRect.height;\n    const width = containerRect.width;\n\n    const color = () => { return \"#9D79A0\"; };\n\n    // const icon = (d) => {\n    //\n    //     return \"\\uf221\";\n    // }\n\n    const getClass = (d) => {\n        return styles.female;\n    };\n\n    const drag = (simulation) => {\n        const dragstarted = (d) => {\n            if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n            d.fx = d.x;\n            d.fy = d.y;\n        };\n\n        const dragged = (d) => {\n            d.fx = d3.event.x;\n            d.fy = d3.event.y;\n        };\n\n        const dragended = (d) => {\n            if (!d3.event.active) simulation.alphaTarget(0);\n            d.fx = null;\n            d.fy = null;\n        };\n\n        return d3\n            .drag()\n            .on(\"start\", dragstarted)\n            .on(\"drag\", dragged)\n            .on(\"end\", dragended);\n    };\n\n    // Add the tooltip element to the graph\n    const tooltip = document.querySelector(\"#graph-tooltip\");\n    if (!tooltip) {\n        const tooltipDiv = document.createElement(\"div\");\n        tooltipDiv.classList.add(styles.tooltip);\n        tooltipDiv.style.opacity = \"0\";\n        tooltipDiv.id = \"graph-tooltip\";\n        document.body.appendChild(tooltipDiv);\n    }\n    const div = d3.select(\"#graph-tooltip\");\n\n    const addTooltip = (hoverTooltip, d, x, y) => {\n        div\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 0.9);\n        div\n            .html(hoverTooltip(d))\n            .style(\"left\", `${x}px`)\n            .style(\"top\", `${y - 28}px`);\n    };\n\n    const removeTooltip = () => {\n        div\n            .transition()\n            .duration(200)\n            .style(\"opacity\", 0);\n    };\n\n    const simulation = d3\n        .forceSimulation(nodes)\n        .force(\"link\", d3.forceLink(links).id(d => d.id))\n        .force(\"charge\", d3.forceManyBody().strength(-150))\n        .force(\"x\", d3.forceX())\n        .force(\"y\", d3.forceY());\n\n    d3.select(container).selectAll(\"svg\").remove();\n\n    const svg = d3\n        .select(container)\n        .append(\"svg\")\n        .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n        .call(d3.zoom().on(\"zoom\", function () {\n            svg.attr(\"transform\", d3.event.transform);\n        }));\n\n    const link = svg\n        .append(\"g\")\n        .attr(\"stroke\", \"#999\")\n        .attr(\"stroke-opacity\", 0.6)\n        .selectAll(\"line\")\n        .data(links)\n        .join(\"line\")\n        .attr(\"stroke-width\", d => Math.sqrt(d.value));\n\n    const node = svg\n        .append(\"g\")\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"stroke-width\", 2)\n        .selectAll(\"circle\")\n        .data(nodes)\n        .join(\"circle\")\n        .attr(\"r\", 12)\n        .attr(\"fill\", color)\n        .call(drag(simulation));\n\n    const label = svg.append(\"g\")\n        .attr(\"class\", \"labels\")\n        .selectAll(\"text\")\n        .data(nodes)\n        .enter()\n        .append(\"text\")\n        .attr('text-anchor', 'bottom')\n        .attr('dominant-baseline', 'central')\n        .attr(\"class\", d => `fa ${getClass(d)}`)\n        // .text(d => {return icon(d);})\n        .text(d => {return d.name;})\n\n        .call(drag(simulation));\n\n    label.on(\"mouseover\", (d) => {\n        addTooltip(nodeHoverTooltip, d, d3.event.pageX, d3.event.pageY);\n    })\n        .on(\"mouseout\", () => {\n            removeTooltip();\n        });\n\n    simulation.on(\"tick\", () => {\n        //update link positions\n        link\n            .attr(\"x1\", d => d.source.x)\n            .attr(\"y1\", d => d.source.y)\n            .attr(\"x2\", d => d.target.x)\n            .attr(\"y2\", d => d.target.y);\n\n        // update node positions\n        node\n            .attr(\"cx\", d => d.x)\n            .attr(\"cy\", d => d.y);\n\n        // update label positions\n        label\n            .attr(\"x\", d => { return d.x; })\n            .attr(\"y\", d => { return d.y; })\n    });\n\n    return {\n        destroy: () => {\n            simulation.stop();\n        },\n        nodes: () => {\n            return svg.node();\n        }\n    };\n}"]},"metadata":{},"sourceType":"module"}